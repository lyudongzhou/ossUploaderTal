import{defineComponent as e,openBlock as n,createBlock as t,createVNode as r,createElementBlock as a,createElementVNode as i,toDisplayString as o,unref as c,withCtx as l,createCommentVNode as s}from"vue";import{ElUpload as u,ElIcon as d,ElMessage as p}from"element-plus";import f from"ali-oss";import{v4 as h}from"uuid";import*as v from"url";function m(e,n,t,r){return new(t||(t=Promise))((function(a,i){function o(e){try{l(r.next(e))}catch(e){i(e)}}function c(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(o,c)}l((r=r.apply(e,n||[])).next())}))}function g(e,n){var t,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=n.call(e,o)}catch(e){i=[6,e],r=0}finally{t=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}var y=e({name:"Plus"});const x={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},b=r("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64h352z"},null,-1);y.render=function(e,r,a,i,o,c){return n(),t("svg",x,[b])},y.__file="packages/components/Plus.vue";var w,k=y;function S(e,n){return m(this,void 0,void 0,(function(){var t,r,a;return g(this,(function(i){switch(i.label){case 0:return[4,n.postJson("/jzx/api/upload/oss/sts/auth")];case 1:if(0!==(t=i.sent().data).errcode)throw new Error(t.errmsg);return[4,new f({region:w.BeiJing,accessKeyId:t.data.AccessKeyId,accessKeySecret:t.data.AccessKeySecret,stsToken:t.data.SecurityToken,bucket:t.data.Bucket}).put("".concat(h(),"-").concat(e.file.name),e.file)];case 2:return r=i.sent(),a=v.parse(r.url,!0),[2,t.data.HttpsDomain+a.path]}}))}))}!function(e){e.HangZhou="oss-cn-hangzhou",e.ShangHai="oss-cn-shanghai",e.QingDao="oss-cn-qingdao",e.BeiJing="oss-cn-beijing",e.ShenZhen="oss-cn-shenzhen",e.HongKong="oss-cn-hongkong"}(w||(w={}));var T={class:"cover"},z={class:"select-title"},q=["src"],B=e({props:{sizeLimit:{type:Number,required:!1,default:5242880},sizeLimitText:{type:String,required:!1,default:"仅支持5M以内的图片文件。"},fileTypes:{type:Array,required:!1,default:function(){return["image/jpeg","image/jpg","image/png"]}},title:{type:String,required:!1,default:"封面"},sender:{type:null,required:!0},modelValue:{type:[String,null],required:!0}},emits:["update:modelValue"],setup:function(e,t){var f=t.emit,h=e;function v(e){return m(this,void 0,void 0,(function(){var n;return g(this,(function(t){switch(t.label){case 0:return e.file.size>h.sizeLimit?(p.error(h.sizeLimitText),[2]):(r=e.file,h.fileTypes.includes(r.type)?[4,S(e,h.sender)]:(p.error("仅支持"+h.fileTypes.map((function(e){return e.split("/")[1]})).join("、")+"格式的图片文件。"),[2]));case 1:return n=t.sent(),f("update:modelValue",n),[2]}var r}))}))}return function(e,t){return n(),a("div",T,[i("div",z,o(h.title),1),r(c(u),{class:"avatar-uploader","http-request":v,accept:h.fileTypes.join(","),action:" "},{default:l((function(){return[r(c(d),{class:"avatar-uploader-icon"},{default:l((function(){return[r(c(k))]})),_:1})]})),_:1},8,["accept"]),h.modelValue?(n(),a("img",{key:0,class:"image",src:h.modelValue},null,8,q)):s("v-if",!0)])}}});!function(e,n){void 0===n&&(n={});var t=n.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===t&&r.firstChild?r.insertBefore(a,r.firstChild):r.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}('.cover[data-v-d5ce1c7e] {\n  display: inline-flex;\n}\n.cover[data-v-d5ce1c7e] [data-v-d5ce1c7e] .el-upload-list {\n  display: none;\n}\n.cover[data-v-d5ce1c7e] .image[data-v-d5ce1c7e] {\n  width: 178px;\n  height: 178px;\n  display: block;\n  margin-left: 10px;\n}\n.cover[data-v-d5ce1c7e] .select-title[data-v-d5ce1c7e] {\n  width: 120px;\n  text-align: right;\n  line-height: 40px;\n  padding: 0 12px 0 0;\n  cursor: default;\n}\n.cover[data-v-d5ce1c7e] .select-title[data-v-d5ce1c7e]:before {\n  content: "*";\n  color: #f56c6c;\n  margin-right: 4px;\n}\n.cover[data-v-d5ce1c7e] [data-v-d5ce1c7e] .el-upload {\n  border: 1px dashed #d9d9d9;\n  border-radius: 6px;\n  cursor: pointer;\n  position: relative;\n  overflow: hidden;\n}\n.cover[data-v-d5ce1c7e] [data-v-d5ce1c7e] .el-upload:hover {\n  border-color: #409eff;\n}\n.cover[data-v-d5ce1c7e] [data-v-d5ce1c7e] .el-icon {\n  font-size: 28px;\n  color: #8c939d;\n  width: 178px;\n  height: 178px;\n  text-align: center;\n  line-height: 178px;\n}\n'),B.__scopeId="data-v-d5ce1c7e",B.__file="src/components/UploadBaodian.vue";var _=[B],V=function(e){_.forEach((function(n){e.component(n.name,n)}))};export{B as UploadBaodian,V as install,S as upload};
//# sourceMappingURL=index.js.map
